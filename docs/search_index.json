[["index.html", "The bifrost R package Chapter 1 Prerequisites", " The bifrost R package Sondre Hølleland and Samuel Subbey, Institute of Marine Research, Norway 2022-02-07 Chapter 1 Prerequisites The R-package bifrost is created for doing the capelin assessment. To install the package, you need R (preferrably version 4.0.3) and Rtools (4.0) R-package devtools Download and install R here: https://cran.uib.no/. Download and install Rtools 4.0 here: https://cran.r-project.org/bin/windows/Rtools/. This will install the necessary C++ compiler for using TMB (template model builder). # If you don&#39;t have devtools: install.packages(&quot;devtools&quot;) devtools::install_github(&quot;holleland/bifrost&quot;, dependencies = TRUE) This should also install e.g. TMB. Software used in development and testing: R version: 4.0.3 Rtools version: 4.0 OS: Windows 10 Financial support: Institute of Marine Research project: 15568 Forvaltningsstrategier for Barentshavet "],["intro.html", "Chapter 2 Introduction", " Chapter 2 Introduction The motivation for creating the bifrost package at Institute of Marine Research (IMR) is to make the capelin assessment more available and reproducible. There has been a tendency that a single person sits on all the knowledge of how to do the assessment and the necessary estimation of parameters, and when this person is no longer available, those left behind are stranded. So we hope that the bifrost R-package can help in terms of availability, transparency and reproducibilility. Another issue with how things used to be done, is that different steps in the assessment used different software. You had one program to estimate parameters in the maturing model, for instance, and another to run Monte Carlo simulations based on these estimates. Here we want a unified software package that allows the user do it all within the same framework. A third element of this project is to move away from having to deal with, say 20 different excel sheets, to load the necessary data for the assessment. Within the procject, multiple research papers has been published. This user-guide will explain how to use the package and what the key features are. The book is divided into chapters. Chapter 3 explains how the input data should be structured and Chapter 4 presents how to estimate the maturity model for capelin, while Chapter 5 explains how to run the Monte Carlo simulations. The Chapter 6 explains how the consumption model works. The following is just kept as example code par(mar = c(4, 4, .1, .1)) plot(pressure, type = &#39;b&#39;, pch = 19) Figure 2.1: Here is a nice figure! Reference a figure by its code chunk label with the fig: prefix, e.g., see Figure 2.1. Similarly, you can reference tables generated from knitr::kable(), e.g., see Table 2.1. knitr::kable( head(iris, 20), caption = &#39;Here is a nice table!&#39;, booktabs = TRUE ) Table 2.1: Here is a nice table! Sepal.Length Sepal.Width Petal.Length Petal.Width Species 5.1 3.5 1.4 0.2 setosa 4.9 3.0 1.4 0.2 setosa 4.7 3.2 1.3 0.2 setosa 4.6 3.1 1.5 0.2 setosa 5.0 3.6 1.4 0.2 setosa 5.4 3.9 1.7 0.4 setosa 4.6 3.4 1.4 0.3 setosa 5.0 3.4 1.5 0.2 setosa 4.4 2.9 1.4 0.2 setosa 4.9 3.1 1.5 0.1 setosa 5.4 3.7 1.5 0.2 setosa 4.8 3.4 1.6 0.2 setosa 4.8 3.0 1.4 0.1 setosa 4.3 3.0 1.1 0.1 setosa 5.8 4.0 1.2 0.2 setosa 5.7 4.4 1.5 0.4 setosa 5.4 3.9 1.3 0.4 setosa 5.1 3.5 1.4 0.3 setosa 5.7 3.8 1.7 0.3 setosa 5.1 3.8 1.5 0.3 setosa You can write citations, too. For example, we are using the bookdown package (Xie 2021) in this sample book, which was built on top of R Markdown and knitr (Xie 2015). References "],["data.html", "Chapter 3 Data 3.1 Maturity data", " Chapter 3 Data There are many data resources necessary to run the full bifrost capelin assessment. We will split this data chapter into the data needed for maturity parameter estimation and the consumption. 3.1 Maturity data For the maturity part of bifrost, we need data from the acoustic survey in the Barents sea, processed by StoX. By running the StoX projects, a file called 2_EstimateByPopulation_Category_Reports_Abundance.txt is produced. At the bottom of this file, you find the following table (example from 2016 survey): ## ## ______________________________________________________________________________________________________ ## Variable: Abundance ## EstLayer: 1 ## Stratum: TOTAL ## species: 162035 ## ______________________________________________________________________________________________________ ## age ## LenGrp 0 1 2 3 4 Number Biomass Mean W ## (1E3) (1E3kg) (g) ## ______________________________________________________________________________________________________ ## 7.5-8.0 | 108413 3196550 - - - 3304964 5109.9 1.55 ## 8.0-8.5 | - 2217823 - - - 2217823 3783.9 1.71 ## 8.5-9.0 | - 2823284 - - - 2823284 5647.8 2.00 ## 9.0-9.5 | - 3281410 - - - 3281410 8391.2 2.56 ## 9.5-10.0 | - 6291983 - - - 6291983 19246.9 3.06 ## 10.0-10.5 | - 3159791 - - - 3159791 11534.3 3.65 ## 10.5-11.0 | - 1931237 13811 - - 1945048 8259.7 4.25 ## 11.0-11.5 | - 2290788 - - - 2290788 12006.9 5.24 ## 11.5-12.0 | - 2248815 82271 - - 2331085 14483.6 6.21 ## 12.0-12.5 | - 4699161 357024 - - 5056185 36801.5 7.28 ## 12.5-13.0 | - 1340294 268462 - - 1608756 13458.5 8.37 ## 13.0-13.5 | - 706850 763254 - - 1470104 14119.9 9.60 ## 13.5-14.0 | - 331121 994703 11299 - 1337122 14680.7 10.98 ## 14.0-14.5 | - 37247 1871252 169922 - 2078422 28255.4 13.59 ## 14.5-15.0 | - 29063 1054995 90411 - 1174470 18218.4 15.51 ## 15.0-15.5 | - 10750 1084263 89633 34848 1219495 21461.7 17.60 ## 15.5-16.0 | - - 580099 429271 - 1009370 20859.0 20.67 ## 16.0-16.5 | - - 629549 420717 74734 1125000 25230.4 22.43 ## 16.5-17.0 | - - 170522 310787 8881 490190 12514.5 25.53 ## 17.0-17.5 | - - 55086 531150 5792 592027 17443.1 29.46 ## 17.5-18.0 | - - 4998 155824 30239 191061 6166.7 32.28 ## 18.0-18.5 | - - - 96756 - 96756 3606.3 37.27 ## 18.5-19.0 | - - 9115 44474 - 53589 1960.2 36.58 ## 19.0-19.5 | - - - 7286 - 7286 324.9 44.59 ## ______________________________________________________________________________________________________ ## TSN(1000) | 108413 34596168 7939404 2357530 154495 45156010 - - ## TSB(1000 kg) | 128.6 144667.9 115752.5 59107.0 3909.2 - 323565.2 - ## Mean length (cm) | 7.50 10.00 14.23 16.19 16.14 - - - ## Mean weight (g) | 1.19 4.18 14.58 25.07 25.30 - - 7.17 ## ______________________________________________________________________________________________________ This is the information we have stored in the example data cap for the years 1972-2019, which you can load by running the following code: data(cap, package = &quot;bifrost&quot;) head(dplyr::filter(cap, year == 2016), n = 10) ## length.group 1 2 3 4 5 sum(10e9) biomass(10e3t) meanweight(g) meanlength(cm) year ## 1 1 0.000 0 0 0 0 0.000 0.000 0.0 5.25 2016 ## 2 2 0.000 0 0 0 0 0.000 0.000 0.0 5.75 2016 ## 3 3 0.000 0 0 0 0 0.000 0.000 0.0 6.25 2016 ## 4 4 0.000 0 0 0 0 0.000 0.000 0.0 6.75 2016 ## 5 5 0.000 0 0 0 0 0.000 0.000 0.0 7.25 2016 ## 6 6 2.753 0 0 0 0 2.753 4.405 1.6 7.75 2016 ## 7 7 2.247 0 0 0 0 2.247 3.820 1.7 8.25 2016 ## 8 8 3.005 0 0 0 0 3.005 6.010 2.0 8.75 2016 ## 9 9 3.501 0 0 0 0 3.501 9.103 2.6 9.25 2016 ## 10 10 5.956 0 0 0 0 5.956 17.868 3.0 9.75 2016 "],["maturity.html", "Chapter 4 Maturity 4.1 The data list", " Chapter 4 Maturity For the capelin assessment, maturity is length based. A simple rule of thumb is that fish larger or equal to 14 cm is mature. The model described here allows for a more delicate modelling of maturity. Let \\(m\\) be the maturity depending on length \\(\\ell\\) of capelin and the two parameters \\(p_1\\) and \\(p_2\\), i.e. \\[\\begin{equation*} m(\\ell) = \\frac{1}{1+\\exp\\{4p_1(p_2 - \\ell)\\}} \\end{equation*}\\] Let \\(N_{\\ell, a}\\) be the number at age \\(a\\) in length group \\(\\ell\\) and \\(\\bar N_a\\) is the number of immature capelin at age \\(a\\). That is \\[\\begin{equation*} \\bar N_a = \\sum_{\\ell} (1-m(\\ell))N_{\\ell,a}. \\end{equation*}\\] The maturity parameters are estimated using Template Model Builder (TMB). 4.1 The data list "],["MCsimulation.html", "Chapter 5 Captool simulation", " Chapter 5 Captool simulation Some significant applications are demonstrated in this chapter. "],["consumption.html", "Chapter 6 Consumption", " Chapter 6 Consumption The consumption module is used to estimate the consumption of capelin by immature cod in the Barents sea. The model therefore use data on both cod and capelin population and estimate the parameters, mainly \\(C_{\\max}\\) and \\(C_{1/2}\\). Symbol Definition \\(a\\), \\(A\\) Age of capelin, Cod \\(\\mbox{Cons}(y,t)\\) Total cod consumption in year \\(y\\), month \\(t\\) \\(\\mbox{MatBio}(y,t)\\) Biomass of maturing capelin \\(\\mbox{PredAbility}(y,t)\\) Predation ability \\(N_{\\mbox{co}}(y,A)\\) Total Number of cod at age \\(A\\) at start of year \\(y\\) \\(\\mbox{O}_{\\mbox{co}}(y,A)\\) Proportion of mature cod \\(\\mbox{SV}(y,A)\\) Proportion of immature cod in Svalbard area \\(W_{\\mbox{co}}(y,A)\\) Weight of age-A cod \\(C_{1/2}\\), \\(C_{\\mbox{max}}\\) (CapTool) Parameters to be estimated in Bifrost \\(\\tilde{C}_{\\mbox{co}}(y,A)\\) Empirically calculated consumption per cod \\(\\mbox{ECons}(y,t,A)\\) Function of empirical consumption \\(z(y,A)\\) Total mortality of cod \\(M_{\\mbox{mc}}(y,t)\\) Natural mortality of capelin Cod consumption in year \\(y\\), month \\(t\\)  Type II FR \\[\\begin{eqnarray} \\mbox{Cons}(y,t) &amp;=&amp; C_{\\mbox{max}}\\cdot \\frac{\\mbox{PredAbility}(y,t)\\cdot \\mbox{MatBio}(y,t)}{C_{1/2} + \\mbox{MatBio}(y,t) } \\\\ \\mbox{MatBio}(y,t) &amp;=&amp; \\sum\\limits_{a=1}^{5}N_{\\mbox{mc}}(y,t,a)W_{\\mbox{mc}}(y,t,a) \\end{eqnarray}\\] PredAbility(y,t): \\[\\begin{eqnarray} &amp;=&amp;\\sum\\limits_{A} N_{\\mbox{co}}(y,t,A)\\cdot \\mbox{CodSuit}(A) \\cdot \\nonumber\\\\ &amp;&amp;[1-\\mbox{O}_{\\mbox{co}}(y,A)]\\cdot [1-\\mbox{SV}(y,A)]\\cdot W_{\\mbox{co}}^{0.801}(y,A) \\end{eqnarray}\\] CodSuit(A)\\(=\\frac{\\lambda^{\\alpha} A^{\\alpha-1} e^{-\\lambda A}}{\\Gamma(\\alpha)}\\) The parameters are estimated by minimizing \\(\\ell\\): \\[\\begin{eqnarray} \\ell &amp;=&amp; \\sum\\limits_{y}\\left(\\sum\\limits_{t}\\mbox{Cons}(y,t) - \\sum\\limits_{A,t}\\mbox{ECons}(y,t,A) \\right)^2\\\\ \\mbox{ECons}(y,t,A) &amp;=&amp; \\tilde{N}_{\\mbox{co}}(y,t,A) \\left[1-\\mbox{O}_{\\mbox{co}}(y,A)\\right] \\left[1-\\mbox{SV}(y,A)\\right] \\tilde{C}_{\\mbox{co}}(y,A) \\nonumber\\\\ \\tilde{N}_{\\mbox{co}}(y,t,A) &amp;=&amp; N_{\\mbox{co}}(y,A)e^{-(t-0.5)*z(y,A)/12}\\\\ M_{\\mbox{mc}}(y,t) &amp;=&amp; -\\ln \\left( 1- \\frac{\\mbox{Cons}(y,t)}{\\mbox{MatBio}(y,t)} \\right) \\end{eqnarray}\\] "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
